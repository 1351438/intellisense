{
  "id": "ea061b96-286a-40df-a055-ab9732bd9020",
  "prevId": "48f104fc-3eb2-409c-8cec-fd0663e949b1",
  "version": "7",
  "dialect": "postgresql",
  "tables": {
    "public.agent_messages": {
      "name": "agent_messages",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "session_id": {
          "name": "session_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "role": {
          "name": "role",
          "type": "varchar(16)",
          "primaryKey": false,
          "notNull": true
        },
        "parts_json": {
          "name": "parts_json",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": true
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "correlation_id": {
          "name": "correlation_id",
          "type": "varchar(64)",
          "primaryKey": false,
          "notNull": true
        }
      },
      "indexes": {
        "agent_messages_session_created_idx": {
          "name": "agent_messages_session_created_idx",
          "columns": [
            {
              "expression": "session_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            },
            {
              "expression": "created_at",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.audit_events": {
      "name": "audit_events",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "actor_type": {
          "name": "actor_type",
          "type": "varchar(32)",
          "primaryKey": false,
          "notNull": true
        },
        "actor_id": {
          "name": "actor_id",
          "type": "varchar(64)",
          "primaryKey": false,
          "notNull": true
        },
        "event_type": {
          "name": "event_type",
          "type": "varchar(128)",
          "primaryKey": false,
          "notNull": true
        },
        "metadata_json": {
          "name": "metadata_json",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": true
        },
        "correlation_id": {
          "name": "correlation_id",
          "type": "varchar(64)",
          "primaryKey": false,
          "notNull": true
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "hash_chain": {
          "name": "hash_chain",
          "type": "varchar(128)",
          "primaryKey": false,
          "notNull": true
        }
      },
      "indexes": {
        "audit_events_created_idx": {
          "name": "audit_events_created_idx",
          "columns": [
            {
              "expression": "created_at",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "audit_events_correlation_idx": {
          "name": "audit_events_correlation_idx",
          "columns": [
            {
              "expression": "correlation_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.chat_sessions": {
      "name": "chat_sessions",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "telegram_chat_id": {
          "name": "telegram_chat_id",
          "type": "varchar(32)",
          "primaryKey": false,
          "notNull": true
        },
        "telegram_user_id": {
          "name": "telegram_user_id",
          "type": "varchar(32)",
          "primaryKey": false,
          "notNull": true
        },
        "message_thread_id": {
          "name": "message_thread_id",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "state_json": {
          "name": "state_json",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": true,
          "default": "'{}'::jsonb"
        },
        "last_message_at": {
          "name": "last_message_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {
        "chat_sessions_chat_user_idx": {
          "name": "chat_sessions_chat_user_idx",
          "columns": [
            {
              "expression": "telegram_chat_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            },
            {
              "expression": "telegram_user_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "chat_sessions_chat_user_thread_idx": {
          "name": "chat_sessions_chat_user_thread_idx",
          "columns": [
            {
              "expression": "telegram_chat_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            },
            {
              "expression": "telegram_user_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            },
            {
              "expression": "message_thread_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.processed_updates": {
      "name": "processed_updates",
      "schema": "",
      "columns": {
        "telegram_update_id": {
          "name": "telegram_update_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "raw_update_json": {
          "name": "raw_update_json",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": true
        },
        "status": {
          "name": "status",
          "type": "processed_update_status",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'received'"
        },
        "received_at": {
          "name": "received_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "handled_at": {
          "name": "handled_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "error": {
          "name": "error",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {
        "processed_updates_telegram_update_id_pk": {
          "name": "processed_updates_telegram_update_id_pk",
          "columns": [
            "telegram_update_id"
          ]
        }
      },
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.telegram_chats": {
      "name": "telegram_chats",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "telegram_chat_id": {
          "name": "telegram_chat_id",
          "type": "varchar(32)",
          "primaryKey": false,
          "notNull": true
        },
        "chat_type": {
          "name": "chat_type",
          "type": "chat_type",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true
        },
        "network": {
          "name": "network",
          "type": "ton_network",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'mainnet'"
        },
        "active_model": {
          "name": "active_model",
          "type": "varchar(128)",
          "primaryKey": false,
          "notNull": true
        },
        "response_style_override": {
          "name": "response_style_override",
          "type": "response_style",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": false
        },
        "risk_profile_override": {
          "name": "risk_profile_override",
          "type": "risk_profile",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": false
        },
        "status": {
          "name": "status",
          "type": "varchar(32)",
          "primaryKey": false,
          "notNull": true,
          "default": "'active'"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {
        "telegram_chats_telegram_chat_id_idx": {
          "name": "telegram_chats_telegram_chat_id_idx",
          "columns": [
            {
              "expression": "telegram_chat_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.telegram_users": {
      "name": "telegram_users",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "telegram_user_id": {
          "name": "telegram_user_id",
          "type": "varchar(32)",
          "primaryKey": false,
          "notNull": true
        },
        "username": {
          "name": "username",
          "type": "varchar(64)",
          "primaryKey": false,
          "notNull": false
        },
        "first_name": {
          "name": "first_name",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": false
        },
        "locale": {
          "name": "locale",
          "type": "varchar(16)",
          "primaryKey": false,
          "notNull": false
        },
        "default_response_style": {
          "name": "default_response_style",
          "type": "response_style",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'concise'"
        },
        "default_risk_profile": {
          "name": "default_risk_profile",
          "type": "risk_profile",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'balanced'"
        },
        "default_network": {
          "name": "default_network",
          "type": "ton_network",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'mainnet'"
        },
        "default_wallet_link_id": {
          "name": "default_wallet_link_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {
        "telegram_users_telegram_user_id_idx": {
          "name": "telegram_users_telegram_user_id_idx",
          "columns": [
            {
              "expression": "telegram_user_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.tool_approvals": {
      "name": "tool_approvals",
      "schema": "",
      "columns": {
        "approval_id": {
          "name": "approval_id",
          "type": "varchar(80)",
          "primaryKey": true,
          "notNull": true
        },
        "callback_token": {
          "name": "callback_token",
          "type": "varchar(32)",
          "primaryKey": false,
          "notNull": true
        },
        "session_id": {
          "name": "session_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "tool_name": {
          "name": "tool_name",
          "type": "varchar(120)",
          "primaryKey": false,
          "notNull": true
        },
        "tool_call_id": {
          "name": "tool_call_id",
          "type": "varchar(120)",
          "primaryKey": false,
          "notNull": true
        },
        "input_json": {
          "name": "input_json",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": true
        },
        "telegram_chat_id": {
          "name": "telegram_chat_id",
          "type": "varchar(32)",
          "primaryKey": false,
          "notNull": true
        },
        "message_thread_id": {
          "name": "message_thread_id",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "prompt_message_id": {
          "name": "prompt_message_id",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "risk_profile": {
          "name": "risk_profile",
          "type": "risk_profile",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'balanced'"
        },
        "status": {
          "name": "status",
          "type": "tool_approval_status",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'requested'"
        },
        "reason": {
          "name": "reason",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "expires_at": {
          "name": "expires_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true
        },
        "decided_at": {
          "name": "decided_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "decided_by": {
          "name": "decided_by",
          "type": "varchar(64)",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {
        "tool_approvals_session_idx": {
          "name": "tool_approvals_session_idx",
          "columns": [
            {
              "expression": "session_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "tool_approvals_callback_token_idx": {
          "name": "tool_approvals_callback_token_idx",
          "columns": [
            {
              "expression": "callback_token",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "tool_approvals_expiry_idx": {
          "name": "tool_approvals_expiry_idx",
          "columns": [
            {
              "expression": "expires_at",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.wallet_links": {
      "name": "wallet_links",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "telegram_user_id": {
          "name": "telegram_user_id",
          "type": "varchar(32)",
          "primaryKey": false,
          "notNull": true
        },
        "address": {
          "name": "address",
          "type": "varchar(128)",
          "primaryKey": false,
          "notNull": true
        },
        "public_key": {
          "name": "public_key",
          "type": "varchar(256)",
          "primaryKey": false,
          "notNull": false
        },
        "wallet_app": {
          "name": "wallet_app",
          "type": "varchar(128)",
          "primaryKey": false,
          "notNull": false
        },
        "label": {
          "name": "label",
          "type": "varchar(64)",
          "primaryKey": false,
          "notNull": false
        },
        "is_default": {
          "name": "is_default",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": false
        },
        "proof_hash": {
          "name": "proof_hash",
          "type": "varchar(128)",
          "primaryKey": false,
          "notNull": true
        },
        "is_active": {
          "name": "is_active",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": true
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {
        "wallet_links_telegram_user_idx": {
          "name": "wallet_links_telegram_user_idx",
          "columns": [
            {
              "expression": "telegram_user_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "wallet_links_address_idx": {
          "name": "wallet_links_address_idx",
          "columns": [
            {
              "expression": "address",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "wallet_links_default_idx": {
          "name": "wallet_links_default_idx",
          "columns": [
            {
              "expression": "telegram_user_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            },
            {
              "expression": "is_default",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    }
  },
  "enums": {
    "public.chat_type": {
      "name": "chat_type",
      "schema": "public",
      "values": [
        "private",
        "group",
        "supergroup",
        "channel"
      ]
    },
    "public.response_style": {
      "name": "response_style",
      "schema": "public",
      "values": [
        "concise",
        "detailed"
      ]
    },
    "public.risk_profile": {
      "name": "risk_profile",
      "schema": "public",
      "values": [
        "cautious",
        "balanced",
        "advanced"
      ]
    },
    "public.ton_network": {
      "name": "ton_network",
      "schema": "public",
      "values": [
        "mainnet",
        "testnet"
      ]
    },
    "public.tool_approval_status": {
      "name": "tool_approval_status",
      "schema": "public",
      "values": [
        "requested",
        "approved",
        "denied",
        "expired",
        "failed"
      ]
    },
    "public.processed_update_status": {
      "name": "processed_update_status",
      "schema": "public",
      "values": [
        "received",
        "enqueued",
        "processed",
        "failed"
      ]
    }
  },
  "schemas": {},
  "sequences": {},
  "roles": {},
  "policies": {},
  "views": {},
  "_meta": {
    "columns": {},
    "schemas": {},
    "tables": {}
  }
}